# Use the same base VM as in the original file
FROM vm/ubuntu:18.04

# Install node and npm
RUN curl -fsSL https://deb.nodesource.com/setup_17.x | bash && \
    apt install -y nodejs && \
    rm -f /etc/apt/sources.list.d/nodesource.list

# Install ts-node globally and other dependencies
RUN npm install -g ts-node

# Copy all project files
COPY . .

# Install project dependencies
RUN npm install

# Set up an HTTP server that runs ts-node neko.ts on every request
COPY neko.ts .


# Run the custom HTTP server in the background
RUN BACKGROUND node server.js

# Expose the app on port 8000
EXPOSE WEBSITE http://localhost:8000
